@using ProjectManagementSystem.ViewModels;
@using ProjectManagementSystem.Data;
@using Microsoft.AspNetCore.Identity;
@using Microsoft.AspNetCore.Http
@model MissionAddViewModel
@inject DataDbContext dataDbContext
@inject UserManager<ApplicationUser> userManager
<form method="post">
    <div class="form-group row">
        <label asp-for="Mission.Name" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Mission.Name">
            <span class="invalid" asp-validation-for="Mission.Name"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Mission.Description" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Mission.Description">
            <span class="invalid" asp-validation-for="Mission.Description"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Mission.CreateDate" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Mission.CreateDate ">
            <span class="invalid" asp-validation-for="Mission.CreateDate"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Mission.UpdateDate" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Mission.UpdateDate">
            <span class="invalid" asp-validation-for="Mission.UpdateDate"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Mission.Deadline" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Mission.Deadline">
            <span class="invalid" asp-validation-for="Mission.Deadline"></span>
        </div>
    </div>


    <div class="form-group row">
        <label asp-for="Mission.Status" class="col-sm-2"></label>
        <div class="col-sm-8">
            <select asp-for="Mission.Status" asp-items="@new SelectList(dataDbContext.MissionStatuses.Select(a=>a.Status).ToList())" class="form-control valid">
            </select>
            <span class="invalid" asp-validation-for="Mission.Status"></span>
        </div>
        <div class="col-sm-2">
            @*<a asp-action="AddTable" class="btn btn-secondary">加</a>*@
            @*  <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
            Launch demo modal
            </button>
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">项目状态</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            @foreach (var item in dataDbContext.ProjectStatuses)
            {
            <div class="col-sm-3">
            <label asp-for="@item.StatusName"></label>
            </div>
            <div class="col-sm-3">
            <a asp-action="DeleteStatus" asp-route-id="@item.Id" class="btn btn-secondary">删除状态</a>
            </div>
            }
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
            </div>
            </div>
            </div>
            </div>*@
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Mission.Executor" class="col-sm-2"></label>
        <div class="col-sm-10">
            <select asp-for="Mission.Executor" asp-items="@new SelectList(userManager.Users.Select(a=>a.UserName).ToList())" class="form-control valid">
            </select>
            <span class="invalid" asp-validation-for="Mission.Executor"></span>
        </div>
    </div>

    @* <div class="form-group row">
    <label asp-for="SelectFunctionarys" class="col-sm-2"></label>
    <div class="col-sm-10">
    @{
    var selectedItems = new List<SelectListItem>();
    foreach (var user in userManager.Users)
    {
    var item = new SelectListItem
    {
    Text = user.UserName,
    Value = user.Id,
    };
    selectedItems.Add(item);
    }
    }
    <select multiple asp-for="Project.Users" asp-items="selectedItems">
    </select>
    <span class="invalid" asp-validation-for="Project.Status"></span>
    </div>
    </div>*@

    <div class="invalid" asp-validation-summary="ModelOnly">
    </div>

    <button type="submit" class="btn btn-primary">提交</button>
    <a asp-action="Index" class="btn btn-secondary">返回列表</a>
</form>