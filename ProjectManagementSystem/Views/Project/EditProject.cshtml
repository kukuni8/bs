@using ProjectManagementSystem.ViewModels;
@using ProjectManagementSystem.Data;
@using Microsoft.AspNetCore.Identity;
@using Microsoft.AspNetCore.Http
@model ProjectEditViewModel
@inject DataDbContext dataDbContext
@inject UserManager<ApplicationUser> userManager
<form method="post" asp-action="EditProject">

    <div class="form-group row" hidden>
        <label asp-for="Project.Id" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Project.Id">
            <span class="invalid" asp-validation-for="Project.Id"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.Name" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Project.Name">
            <span class="invalid" asp-validation-for="Project.Name"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.Description" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Project.Description">
            <span class="invalid" asp-validation-for="Project.Description"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.CreatedDate" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Project.CreatedDate">
            <span class="invalid" asp-validation-for="Project.CreatedDate"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.UpdatedDate" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Project.UpdatedDate">
            <span class="invalid" asp-validation-for="Project.UpdatedDate"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.Deadline" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Project.Deadline">
            <span class="invalid" asp-validation-for="Project.Deadline"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.Budget" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input class="form-control" asp-for="Project.Budget">
            <span class="invalid" asp-validation-for="Project.Budget"></span>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.Status" class="col-sm-2"></label>
        <div class="col-sm-8">
            <select asp-for="Project.Status" asp-items="@new SelectList(dataDbContext.ProjectStatuses.Select(a=>a.StatusName).ToList())" class="form-control valid">
            </select>
            <span class="invalid" asp-validation-for="Project.Status"></span>
        </div>
        <div class="col-sm-2">
            @*  <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
            Launch demo modal
            </button>
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">项目状态</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            @foreach (var item in dataDbContext.ProjectStatuses)
            {
            <div class="col-sm-3">
            <label asp-for="@item.StatusName"></label>
            </div>
            <div class="col-sm-3">
            <a asp-action="DeleteStatus" asp-route-id="@item.Id" class="btn btn-secondary">删除状态</a>
            </div>
            }
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
            </div>
            </div>
            </div>
            </div>*@
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Project.PutForward" class="col-sm-2"></label>
        <div class="col-sm-10">
            <input readonly asp-for="Project.PutForward" value="@Model.Project.PutForward" class="form-control valid">
            <span class="invalid" asp-validation-for="Project.PutForward"></span>
        </div>
    </div>
    <div class="form-group row">
        <label asp-for="Project.Functionary" class="col-sm-2"></label>
        <div class="col-sm-10">
            <select asp-for="Project.Functionary" asp-items="@new SelectList(userManager.Users.Select(a=>a.UserName).ToList())" class="form-control valid">
            </select>
            <span class="invalid" asp-validation-for="Project.Functionary"></span>
        </div>
    </div>

    @* <div class="form-group row">
    <label asp-for="SelectFunctionarys" class="col-sm-2"></label>
    <div class="col-sm-10">
    @{
    var selectedItems = new List<SelectListItem>();
    foreach (var user in userManager.Users)
    {
    var item = new SelectListItem
    {
    Text = user.UserName,
    Value = user.Id,
    };
    selectedItems.Add(item);
    }
    }
    <select multiple asp-for="Project.Users" asp-items="selectedItems">
    </select>
    <span class="invalid" asp-validation-for="Project.Status"></span>
    </div>
    </div>*@

    <div class="invalid" asp-validation-summary="ModelOnly">
    </div>

    <button type="submit" class="btn btn-primary">提交</button>
    <a asp-action="Index" class="btn btn-secondary">返回列表</a>
</form>